################################################################################
# Example usage



import os
import shutil

if os.path.exists("logs/wasm.log"):
    os.remove("logs/wasm.log")

try:
    directory = 'testing/js_testing/JS_MOUNT/'
    source_directory = 'testing/js_testing/JS_MOUNT2/'
    # Loop through and remove each file and directory
    for filename in os.listdir(directory):
        file_path = os.path.join(directory, filename)
        if os.path.isdir(file_path):
            shutil.rmtree(file_path)
        else:
            os.remove(file_path)
    
    shutil.copytree(source_directory, directory, dirs_exist_ok=True)

except Exception as e:
    print(e)

import logging
# from FS import FS
logging.basicConfig(
    filename="logs/wasm.log",
    level=logging.INFO,
    format="%(asctime)s - %(levelname)s - %(message)s",
)

import sys
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'src')))
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'testing')))
import time
from services.lok_service import LokService
from JS2PY import LOK_JS2PY

lok = LOK_JS2PY("testing/js_testing/test5.wasm")
lok.HEAP32[5948976//4] = 11191872
lok.HEAP32[5948960//4] =  5524807


#'invoke_vii' (index == 19356) && (a1 == 5949360) && (a2 == 5949408) ||| {5949364: 0, 5914048: 11197032, 5913976: 284, 5913992: 11191872, 5913996: 18204200, 5914000: 26200288}
#'invoke_iii' (index == 19161) && (a1 == 5949412) && (a2 == 12446752) ||| {5949364: 12448088, 5914048: 11197032, 5913976: 280, 5913992: 11191872, 5913996: 18204200, 5914000: 26200288}
# 17152200 vs 12448088 


#'invoke_iii' (index == 19161) && (a1 == 17686048) && (a2 == 0) ||| {17148016: 2036421178, 5914048: 11197032, 5913976: 280, 5913992: 11191872, 5913996: 18204200, 5914000: 26200288}
#'invoke_iii' (index == 19161) && (a1 == 5949364) && (a2 == 18205216) ||| {17148016: 2036421178, 5914048: 11197200, 5913976: 280, 5913992: 11191872, 5913996: 18204200, 5914000: 26200288}
# expect to call 'invoke_iii' (index == 19161) && (a1 == 5949364) && (a2 == 17123352) instead of 'invoke_iii' (index == 19161) && (a1 == 5949364) && (a2 == 18205216)
# a2: 18205216 vs 17123352

# 5914048: 13237224
#  'invoke_vii' (index == 19359) && (a1 == 17690468) && (a2 == 5949464) ||| {17148016: 2036421178, 5914048: 17369240, 5913976: 37160, 5913992: 11191872, 5913996: 17685824, 5914000: 26200288}
# expect 17378264 , current value 17369240

# culprit was 37120
# it performs (value >> 2) & 3
# (37120 >> 2 ) &3 = 0 # Failed here
# (37128 >> 2 ) &3 = 2 # 
# 2024-09-11 23:07:32,669 - INFO - 'invoke_iii' (index == 19161) && (a1 == 17691772) && (a2 == 0) ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,670 - INFO - from custom log: 9054801 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,670 - INFO - from custom log: 8977903 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,670 - INFO - from custom log: 8987401 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,670 - INFO - from custom log: 9277319 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,671 - INFO - from custom log: 9277320 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,671 - INFO - from custom log: 9277323 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,671 - INFO - from custom log: 9277322 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,671 - INFO - from custom log: 9277321 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,672 - INFO - from custom log: 9277301 ||| {5913976: 37128, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,672 - INFO - from custom log: 9277601 ||| {5913976: 37120, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,672 - INFO - from custom log: 8987402 ||| {5913976: 37120, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,672 - INFO - from custom log: 8977901 ||| {5913976: 37120, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}
# 2024-09-11 23:07:32,673 - INFO - from custom log: 9054802 ||| {5913976: 37120, 5913992: 11191872, 5913996: 17685896, 5914000: 26200288}

#A:'invoke_iii' (index == 19161) && (a1 == 17694332) && (a2 == 0) ||| {5913996: 17685896, 5914000: 26200288}
#B:'invoke_iii' (index == 19161) && (a1 == 17694392) && (a2 == 0) ||| {5913996: 17685912, 5914000: 26200288}
# when transit from A to B, 5913996 is expect to remain at 17685896

############# <><>
# idx 68,680 + 9,536
# 5914000 expect 27086864, but current value 27086864 
# 5913996 expect 27009840, but current value 27007176
#'invoke_vii' >> set breakpoint >> (index == 19232) && (a1 == 18200992) && (a2 ==  1890) 
#'invoke_vii' (19232, 18200992, 1890) ||| {5914000: 27086864, 5913988: 4040, 5913980: 0, 5913984: 14144, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 27007176, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -180, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 17805928, 5914044: 17805928, 5914048: 17784840, 5914052: 17784840, 5914056: 17772568, 5914060: 17772568, 5914064: 27003648, 5914068: 27003648, 5914072: 17771032, 5914076: 17771032, 5914080: 27005504, 5914084: 27005504, 5914088: 17805880, 5914092: 17805880, 5914096: 17788672, 5914100: 17788672, 5914104: 17785168, 5914108: 17785168, 5914112: 17695040, 5914116: 17695040, 5914120: 18204200, 5914124: 18204200, 5914128: 17685968, 5914132: 17685968, 5914136: 17784368, 5914140: 17783216, 5914144: 17770960, 5914148: 17770792, 5914152: 17685496, 5914156: 17685496, 5914160: 17785840, 5914164: 17785840, 5914168: 26989856, 5914172: 17771384, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 17725648, 5914244: 17725648, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 17685496, 5914268: 17685496, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 15112640, 5914412: 15112640, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 102400, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}

# 17785028 = 17784976 +52
# idx 68,680 + 9,537
#param expect (19235, 5949412, 17785028), but current value (19235, 5949412, 17785364)
#'invoke_vii' (19235, 5949412, 17785364) ||| {5914000: 27086864, 5913988: 4040, 5913980: 0, 5913984: 14144, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 27007176, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -180, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 17805928, 5914044: 17805928, 5914048: 17784840, 5914052: 17784840, 5914056: 17772568, 5914060: 17772568, 5914064: 27003648, 5914068: 27003648, 5914072: 17771032, 5914076: 17771032, 5914080: 27005504, 5914084: 27005504, 5914088: 17805880, 5914092: 17805880, 5914096: 17788672, 5914100: 17788672, 5914104: 17785168, 5914108: 17785168, 5914112: 17695040, 5914116: 17695040, 5914120: 18204200, 5914124: 18204200, 5914128: 17685968, 5914132: 17685968, 5914136: 17784368, 5914140: 17783216, 5914144: 17770960, 5914148: 17770792, 5914152: 17685496, 5914156: 17685496, 5914160: 17785840, 5914164: 17785840, 5914168: 26989856, 5914172: 17771384, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 17725648, 5914244: 17725648, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 17685496, 5914268: 17685496, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 15112640, 5914412: 15112640, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 102400, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}


# never hit
# idx 68,680 + 9,539
# 5914000 expect ??? , but current value 27086864 
#'invoke_viii' >> set breakpoint >> (index == 14922) && (a1 == 5949360) && (a2 ==  17785312) && (a3 ==  1024)
# 'invoke_viii' (14922, 5949360, 17785312, 1024) ||| {5914000: 27086864, 5913988: 4040, 5913980: 0, 5913984: 14144, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 27007176, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -180, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 17805928, 5914044: 17805928, 5914048: 17784840, 5914052: 17784840, 5914056: 17772568, 5914060: 17772568, 5914064: 27003648, 5914068: 27003648, 5914072: 17771032, 5914076: 17771032, 5914080: 27005504, 5914084: 27005504, 5914088: 17805880, 5914092: 17805880, 5914096: 17788672, 5914100: 17788672, 5914104: 17785168, 5914108: 17785168, 5914112: 17695040, 5914116: 17695040, 5914120: 18204200, 5914124: 18204200, 5914128: 17685968, 5914132: 17685968, 5914136: 17784368, 5914140: 17783216, 5914144: 17770960, 5914148: 17770792, 5914152: 17685496, 5914156: 17685496, 5914160: 17785840, 5914164: 17785840, 5914168: 26989856, 5914172: 17771384, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 17725648, 5914244: 17725648, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 17685496, 5914268: 17685496, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 15112640, 5914412: 15112640, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 102400, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}


# never hit
#idx 68,680 + 15,000
# 5914000 expect ????? , but current value 27138416 
#'invoke_viiii' >> set breakpoint >> (index == 7876) && (a1 == 17785312) && (a2 ==  19357303)  && (a3 ==  5949360)  && (a4 ==  27138152) 
#'invoke_viiii' (7876, 17785312, 19357303, 5949360, 27138152) ||| {5914000: 27138416, 5913988: 1640, 5913980: 0, 5913984: 0, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 0, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -182, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27103240, 5914044: 27103240, 5914048: 27003128, 5914052: 27003128, 5914056: 27089088, 5914060: 27089088, 5914064: 17785208, 5914068: 17785208, 5914072: 17771032, 5914076: 17771032, 5914080: 27098328, 5914084: 27009144, 5914088: 17805880, 5914092: 17805880, 5914096: 17784408, 5914100: 17788672, 5914104: 17785168, 5914108: 17785168, 5914112: 27009144, 5914116: 27009144, 5914120: 18204200, 5914124: 18204200, 5914128: 17685968, 5914132: 17685968, 5914136: 17783984, 5914140: 17783216, 5914144: 17770960, 5914148: 17770792, 5914152: 17685496, 5914156: 17685496, 5914160: 17785840, 5914164: 17785840, 5914168: 26989856, 5914172: 17771384, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 17725648, 5914244: 17725648, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 17685496, 5914268: 17685496, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 15161792, 5914412: 15161792, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 151552, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}


#idx 130,000
# 5914000 expect 27601400 , but current value 27601544 
#'invoke_vii' >> set breakpoint >> (index == 19266) && (a1 == 27597968) && (a2 ==  5949360) 
#'invoke_vii' (19266, 27597968, 5949360) ||| {5914000: 27601544, 5913988: 1360, 5913980: 16384, 5913984: 0, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 0, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -200, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27165104, 5914044: 27165104, 5914048: 26202048, 5914052: 26202048, 5914056: 11196928, 5914060: 11196928, 5914064: 27170040, 5914068: 27170040, 5914072: 17791000, 5914076: 17791000, 5914080: 27171136, 5914084: 27171136, 5914088: 27184488, 5914092: 27184488, 5914096: 27179784, 5914100: 27179784, 5914104: 27170000, 5914108: 27170000, 5914112: 27184592, 5914116: 27184592, 5914120: 18204200, 5914124: 18204200, 5914128: 17811672, 5914132: 17811672, 5914136: 17783216, 5914140: 17783216, 5914144: 17770792, 5914148: 17770792, 5914152: 27179784, 5914156: 27179784, 5914160: 27183816, 5914164: 27183816, 5914168: 27171136, 5914172: 27171136, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 27179784, 5914244: 27179784, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 27165104, 5914268: 27165104, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 27307376, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 15624640, 5914412: 15624640, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 614400, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}


# 5914000 expect 30077176 , but current value 30077320 
# 5914000 expect 29290736 , but current value 29290880 
# invoke_viii >> set breakpoint >> (index == 14933) && (a1 == 5949312) && (a2 ==  5272112) && (a3== 65536)
#'invoke_viii' (14933, 5949312, 5272112, 65536) ||| {5914000: 29290880, 5913988: 3672, 5913980: 1048576, 5913984: 0, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 0, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -206, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27165104, 5914044: 27165104, 5914048: 26202048, 5914052: 26202048, 5914056: 27806984, 5914060: 27806984, 5914064: 27170040, 5914068: 27170040, 5914072: 17791000, 5914076: 17791000, 5914080: 27171136, 5914084: 27171136, 5914088: 27184488, 5914092: 27184488, 5914096: 27688928, 5914100: 27688928, 5914104: 27170000, 5914108: 27170000, 5914112: 27184592, 5914116: 27184592, 5914120: 18204200, 5914124: 18204200, 5914128: 27806984, 5914132: 27806984, 5914136: 17783216, 5914140: 17783216, 5914144: 17770792, 5914148: 17770792, 5914152: 27179784, 5914156: 27179784, 5914160: 27183816, 5914164: 27183816, 5914168: 27171136, 5914172: 27171136, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 27179784, 5914244: 27179784, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 27165104, 5914268: 27165104, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 28000536, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 17316288, 5914412: 17316288, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 2306048, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}
#'getTotalMemory' () ||| {5914000: 29290880, 5913988: 3672, 5913980: 1048576, 5913984: 0, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 0, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -206, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27165104, 5914044: 27165104, 5914048: 26202048, 5914052: 26202048, 5914056: 27806984, 5914060: 27806984, 5914064: 27170040, 5914068: 27170040, 5914072: 17791000, 5914076: 17791000, 5914080: 27171136, 5914084: 27171136, 5914088: 27184488, 5914092: 27184488, 5914096: 27688928, 5914100: 27688928, 5914104: 27170000, 5914108: 27170000, 5914112: 27184592, 5914116: 27184592, 5914120: 18204200, 5914124: 18204200, 5914128: 27806984, 5914132: 27806984, 5914136: 17783216, 5914140: 17783216, 5914144: 17770792, 5914148: 17770792, 5914152: 27179784, 5914156: 27179784, 5914160: 27183816, 5914164: 27183816, 5914168: 27171136, 5914172: 27171136, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 27179784, 5914244: 27179784, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 27165104, 5914268: 27165104, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 28000536, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 17316288, 5914412: 17316288, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 2306048, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}
#from funcname 92773, {0: 786440, 1: 790104, 2: 3664, 3: 29290880, 4: 29290880, 5: 2306048, 6: 26988544, 7: 786488, 8: 5914428, 9: 26988544, 10: 5949424, 11: 0, 12: 0, 34: 29290880, 35: 30077320, 5084484: 4939776, 5202024: 12320000, 5913980: 1048576, 5913984: 0, 5913988: 3664, 5913996: 0, 5914000: 29290880, 5914448: 1427084056, 5914456: 4096, 5949232: 1414868480, 5949244: 0}
#'invoke_vii' (19266, 29290888, 5949360) ||| {5914000: 30077320, 5913988: 3664, 5913980: 1048576, 5913984: 0, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 0, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -206, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27165104, 5914044: 27165104, 5914048: 26202048, 5914052: 26202048, 5914056: 27806984, 5914060: 27806984, 5914064: 27170040, 5914068: 27170040, 5914072: 17791000, 5914076: 17791000, 5914080: 27171136, 5914084: 27171136, 5914088: 27184488, 5914092: 27184488, 5914096: 27688928, 5914100: 27688928, 5914104: 27170000, 5914108: 27170000, 5914112: 27184592, 5914116: 27184592, 5914120: 18204200, 5914124: 18204200, 5914128: 27806984, 5914132: 27806984, 5914136: 17783216, 5914140: 17783216, 5914144: 17770792, 5914148: 17770792, 5914152: 27179784, 5914156: 27179784, 5914160: 27183816, 5914164: 27183816, 5914168: 27171136, 5914172: 27171136, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 27179784, 5914244: 27179784, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 27165104, 5914268: 27165104, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 0, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 28000536, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 18102720, 5914412: 18102720, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 3092480, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}

# 5949244 expect  28522672, but current value: 28522816
# invoke_viii >> set breakpoint >> (index == 14890) && (a1 == 5949244) && (a2 ==  4902040) && (a3== 26)
#'invoke_viii' (14890, 5949244, 4902040, 26) ||| {5949244: 0}
#'invoke_viii' (14890, 5949232, 4902067, 3) ||| {5949244: 28522816}
#'invoke_vii' (19285, 5949244, 5949232) ||| {5949244: 28522816}
#'_setenv' (28522816, 5949232, 1) ||| {5949244: 28522816}

#'invoke_viii' (14890, 5949244, 4902040, 26) ||| {5914000: 30077320, 5913988: 3664, 5913980: 128, 5913984: 133112, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 1414868480, 5084484: 4939776, 5913996: 28522800, 5949244: 0, 5913992: 11191872, 5914004: -1, 5914008: -208, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27165104, 5914044: 27165104, 5914048: 26202048, 5914052: 26202048, 5914056: 27806984, 5914060: 27806984, 5914064: 27170040, 5914068: 27170040, 5914072: 17791000, 5914076: 17791000, 5914080: 27171136, 5914084: 27171136, 5914088: 27184488, 5914092: 27184488, 5914096: 27688928, 5914100: 27688928, 5914104: 27170000, 5914108: 27170000, 5914112: 27184592, 5914116: 27184592, 5914120: 18204200, 5914124: 18204200, 5914128: 27806984, 5914132: 27806984, 5914136: 17783216, 5914140: 17783216, 5914144: 17770792, 5914148: 17770792, 5914152: 27179784, 5914156: 27179784, 5914160: 27183816, 5914164: 27183816, 5914168: 27171136, 5914172: 27171136, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 27179784, 5914244: 27179784, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 27165104, 5914268: 27165104, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 28519288, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 18102720, 5914412: 18102720, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 3092480, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}
#from funcname 6090, {0: 4939776, 1: 32, 2: 16, 3: 5949280, 4: 0, 5: 4365577, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 5084484: 4939776, 5202024: 12320000, 5913980: 128, 5913984: 133112, 5913988: 3664, 5913996: 28522800, 5914000: 30077320, 5914448: 1427084056, 5914456: 4096, 5949232: 1414868480, 5949244: 0}
#'invoke_viii' (14890, 5949232, 4902067, 3) ||| {5914000: 30077320, 5913988: 3664, 5913980: 128, 5913984: 133056, 5914448: 1427084056, 5914456: 4096, 5202024: 12320000, 5949232: 0, 5084484: 4939776, 5913996: 28522856, 5949244: 28522816, 5913992: 11191872, 5914004: -1, 5914008: -208, 5914012: 1427084056, 5914016: 0, 5914020: 0, 5914024: 5914016, 5914028: 5914016, 5914032: 5914024, 5914036: 5914024, 5914040: 27165104, 5914044: 27165104, 5914048: 26202048, 5914052: 26202048, 5914056: 27806984, 5914060: 27806984, 5914064: 27170040, 5914068: 27170040, 5914072: 17791000, 5914076: 17791000, 5914080: 27171136, 5914084: 27171136, 5914088: 27184488, 5914092: 27184488, 5914096: 27688928, 5914100: 27688928, 5914104: 27170000, 5914108: 27170000, 5914112: 27184592, 5914116: 27184592, 5914120: 18204200, 5914124: 18204200, 5914128: 27806984, 5914132: 27806984, 5914136: 17783216, 5914140: 17783216, 5914144: 17770792, 5914148: 17770792, 5914152: 27179784, 5914156: 27179784, 5914160: 27183816, 5914164: 27183816, 5914168: 27171136, 5914172: 27171136, 5914176: 17691968, 5914180: 17691968, 5914184: 17688328, 5914188: 17688328, 5914192: 17811608, 5914196: 17811608, 5914200: 17688504, 5914204: 17688504, 5914208: 17790960, 5914212: 17790960, 5914216: 26201880, 5914220: 26201880, 5914224: 17690664, 5914228: 17690664, 5914232: 17771600, 5914236: 17771600, 5914240: 27179784, 5914244: 27179784, 5914248: 17688504, 5914252: 17688504, 5914256: 17691584, 5914260: 17691584, 5914264: 27165104, 5914268: 27165104, 5914272: 17691440, 5914276: 17691440, 5914280: 0, 5914284: 0, 5914288: 0, 5914292: 0, 5914296: 0, 5914300: 0, 5914304: 0, 5914308: 28519288, 5914312: 0, 5914316: 0, 5914320: 0, 5914324: 0, 5914328: 0, 5914332: 0, 5914336: 0, 5914340: 0, 5914344: 0, 5914348: 0, 5914352: 0, 5914356: 0, 5914360: 0, 5914364: 0, 5914368: 0, 5914372: 0, 5914376: 0, 5914380: 0, 5914384: 0, 5914388: 0, 5914392: 0, 5914396: 0, 5914400: 0, 5914404: 0, 5914408: 18102720, 5914412: 18102720, 5914416: 0, 5914420: 0, 5914424: 26988544, 5914428: 3092480, 5914432: 26202080, 5914436: 0, 5914440: 0, 5914444: 0, 5914452: 4096}

# self.func_tables[165449]
# func 93038 (93040)
# func 6170 (6172)
lok._AT_INIT()
lok._AT_MAIN()
a = LokService()
a.login()
token = a.accessToken

URL = f"wss://socf-lok-live.leagueofkingdoms.com/socket.io/?EIO=4&transport=websocket&token={token}"
lok._WS_Create(URL, '', 17058,17691,14198,17692,14199 )
print('\ndebug started')
# set breakpoint at 
#  def _WS_Create
# >> on_message_wrapper

#track this const 5913980
#track this const 5913984
#track this const 5913988
# culprit found 5914000


# 2024-08-25 00:30:48,424 - INFO - from funcname 93115, placeholder 3 : 4096
# 2024-08-25 00:30:48,425 - INFO - from funcname 93115, placeholder 4 : 1114112
# expect 11191872 for from funcname 93115, placeholder 3
# expect 0 for from funcname 93115, placeholder 4

# 2024-07-28 21:15:01,881 - INFO - _syscall4 not implemented
# Fill missing function if any
time.sleep(300)