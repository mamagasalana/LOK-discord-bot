################################################################################
# Example usage



import os
import shutil

if os.path.exists("logs/wasm.log"):
    os.remove("logs/wasm.log")

try:
    directory = 'testing/js_testing/JS_MOUNT/'
    source_directory = 'testing/js_testing/JS_MOUNT2/'
    # Loop through and remove each file and directory
    for filename in os.listdir(directory):
        file_path = os.path.join(directory, filename)
        if os.path.isdir(file_path):
            shutil.rmtree(file_path)
        else:
            os.remove(file_path)
    
    shutil.copytree(source_directory, directory, dirs_exist_ok=True)

except Exception as e:
    print(e)

import logging
# from FS import FS
logging.basicConfig(
    filename="logs/wasm.log",
    level=logging.INFO,
    format="%(asctime)s - %(levelname)s - %(message)s",
)

import sys
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'src')))
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'testing')))
import time
from services.lok_service import LokService
from JS2PY import LOK_JS2PY

lok = LOK_JS2PY("testing/js_testing/test.wasm")

# lok.HEAP32[5948976>>2] = 11191872
# lok.HEAP32[5948960>>2] =  5524807
# lok._AT_INIT()
# lok._AT_MAIN()

import numpy as np
with open('before.bin', 'rb') as ifile:
    heap8 = np.frombuffer(ifile.read(), dtype=np.uint8)

lok.reallocBuffer(heap8.size)
np.copyto(lok.HEAP8, heap8)



response = '42["/field/objects/v4",{"isPackCompressed":true,"packs":[31,139,8,0,0,0,0,0,0,3,189,125,77,115,227,56,178,237,15,122,139,71,214,184,38,228,197,93,36,72,0,20,109,170,12,146,0,37,237,100,82,130,110,139,245,236,25,105,46,120,251,215,191,3,202,53,221,34,89,42,171,195,227,85,71,84,88,18,65,100,158,143,204,4,218,232,102,39,219,133,54,76,231,92,45,254,33,247,172,203,29,47,212,254,152,80,152,86,145,155,137,138,142,43,25,206,169,180,71,34,203,150,76,113,102,196,42,163,67,83,139,240,165,140,203,87,197,114,77,134,221,237,100,108,235,170,53,90,41,245,141,171,140,202,156,45,148,18,166,178,89,204,194,166,32,103,153,102,119,217,210,230,145,52,170,140,243,87,210,98,109,24,35,157,8,45,11,58,16,11,217,55,110,78,60,18,95,31,114,119,90,86,118,241,32,202,187,71,211,29,31,149,83,155,196,240,121,105,131,121,220,54,75,70,135,68,187,236,185,12,73,42,58,112,163,23,248,236,190,137,205,233,73,209,218,100,38,40,99,189,208,212,206,226,138,154,167,196,164,186,84,123,109,12,43,152,56,166,68,226,161,176,89,97,216,169,168,240,8,120,230,24,15,191,77,90,69,69,174,241,248,58,206,131,46,82,206,238,176,94,29,235,147,50,202,126,171,14,225,220,255,91,210,106,194,51,55,66,185,184,248,91,200,121,184,200,114,215,174,99,78,101,140,223,32,119,192,155,189,203,42,203,162,168,101,162,98,217,243,74,176,199,243,122,57,222,213,137,47,109,32,215,225,62,138,254,223,233,33,22,247,219,216,152,70,6,217,55,125,120,21,105,120,170,139,223,25,37,98,47,180,53,20,229,71,60,31,109,40,212,49,158,35,89,133,172,140,212,139,168,220,106,67,162,150,170,202,202,31,159,205,194,102,91,186,46,74,206,239,64,145,59,138,146,230,13,133,74,62,146,141,99,179,80,145,58,200,210,101,85,242,219,204,191,131,166,162,148,162,106,30,155,14,123,25,28,88,249,93,97,109,244,109,25,50,21,135,226,17,207,247,88,125,95,175,116,176,88,113,53,35,230,104,41,157,138,203,48,224,204,42,196,199,65,146,123,125,74,148,208,201,254,136,207,206,226,101,235,202,170,99,255,168,58,81,114,134,127,203,241,236,12,123,249,55,190,75,196,202,255,46,171,216,42,81,249,241,81,147,110,18,51,143,75,69,137,95,135,105,247,134,113,214,250,56,72,196,186,222,157,223,65,162,195,172,146,102,46,148,57,34,14,106,138,236,94,87,102,241,40,221,10,143,59,243,239,64,154,195,107,193,195,211,182,178,221,78,236,143,143,162,12,178,181,232,26,106,195,184,8,12,23,93,171,196,255,234,101,30,190,174,149,89,68,202,118,185,104,95,245,198,205,254,207,114,121,191,226,129,216,196,118,191,139,91,151,43,247,53,90,242,46,198,223,213,133,83,202,180,98,171,56,103,120,47,69,180,79,159,148,109,215,210,52,133,62,240,74,183,199,92,152,215,71,197,77,41,4,43,150,156,83,222,178,134,153,19,21,218,112,105,142,248,190,67,178,204,91,65,156,165,69,199,149,196,158,47,45,101,90,184,156,218,134,124,188,84,98,191,211,1,127,90,242,123,173,242,244,159,38,110,183,169,104,194,138,102,113,30,226,239,68,247,16,219,208,8,126,200,205,126,30,171,174,61,197,95,190,210,179,59,233,74,228,219,156,153,168,106,115,22,31,216,166,116,39,94,9,129,180,204,35,163,187,221,147,113,62,127,17,107,249,76,91,71,230,112,242,49,190,73,248,161,16,102,159,110,173,122,210,166,139,249,158,180,12,125,156,222,55,198,174,41,210,243,146,194,197,34,47,215,43,169,91,45,204,169,76,186,19,35,190,222,20,93,179,125,8,133,202,241,104,145,218,103,72,30,182,220,139,181,8,235,62,207,151,45,219,101,38,92,23,93,93,40,219,231,204,227,114,105,180,8,155,40,22,51,134,56,80,149,11,22,57,192,134,155,58,19,162,89,248,152,52,118,38,234,55,140,136,41,175,133,143,33,21,36,185,233,154,183,188,52,196,15,200,183,125,65,214,49,252,238,31,251,241,27,95,84,173,255,41,187,150,8,73,165,14,12,177,97,150,252,212,176,165,207,183,89,84,238,117,89,169,186,2,254,61,168,16,123,100,217,28,120,229,255,46,203,91,85,86,46,45,117,112,40,34,177,150,122,191,192,218,90,191,182,68,209,98,215,99,147,154,47,76,136,24,119,180,197,111,80,161,14,228,63,171,219,92,227,119,179,210,181,53,48,105,103,40,143,180,64,44,154,166,142,253,123,62,116,181,193,142,188,225,228,67,213,53,185,68,156,44,247,250,217,255,155,86,115,224,144,174,171,195,73,231,142,30,251,252,0,118,150,140,85,201,247,21,225,221,231,12,207,78,65,51,47,226,87,78,216,143,141,96,120,190,99,163,66,246,92,208,226,127,226,118,223,40,171,238,9,241,143,47,217,34,167,11,121,232,150,186,252,234,127,55,53,251,31,223,183,22,229,158,39,207,116,244,235,136,98,106,68,210,222,255,75,33,247,243,182,251,151,238,128,87,135,35,158,83,151,38,71,100,87,43,31,47,43,201,127,124,223,93,85,28,90,253,100,57,246,173,238,113,77,171,250,30,129,217,96,31,187,68,215,15,5,171,1,215,33,45,77,167,89,21,246,188,144,58,123,198,73,11,156,84,115,191,151,219,196,116,102,195,234,120,25,116,248,190,12,223,135,119,208,54,90,91,125,223,115,133,12,106,31,47,248,16,99,161,40,8,207,20,135,205,99,241,219,171,68,30,113,253,91,191,54,31,7,84,56,166,211,240,117,171,29,222,1,243,248,50,127,195,236,23,143,77,137,105,195,127,137,112,17,85,142,253,79,1,126,97,193,240,249,130,63,63,223,102,252,124,171,243,243,29,66,240,203,93,161,252,111,184,126,223,168,96,160,26,103,159,12,222,125,165,192,91,253,94,134,58,207,179,199,60,92,199,178,231,0,177,0,119,150,21,205,89,126,104,87,12,188,42,216,93,241,7,30,116,119,44,71,220,139,140,37,246,56,199,146,115,38,2,174,69,147,37,161,78,164,21,10,95,35,77,142,61,15,12,91,82,171,123,206,51,11,237,227,154,31,214,79,149,69,72,90,139,245,214,143,202,116,173,228,41,112,28,216,157,155,63,243,234,58,113,121,129,7,102,68,121,201,194,163,199,246,181,180,53,147,225,9,242,192,243,170,217,18,240,160,49,181,52,224,15,25,102,255,23,185,223,48,158,63,170,3,246,215,199,6,221,73,191,94,188,3,255,158,89,255,158,115,14,220,220,215,202,237,77,204,22,185,224,157,199,141,101,207,141,122,22,197,108,205,165,14,127,96,137,150,58,77,150,196,52,114,176,132,208,80,172,83,164,243,89,45,99,206,74,202,4,137,211,146,237,235,200,168,69,16,51,91,83,119,250,215,242,141,23,140,93,60,21,173,74,10,250,170,25,246,192,243,62,112,43,67,94,85,165,177,61,55,46,197,75,89,125,57,212,136,93,86,118,128,148,184,243,107,251,129,67,209,165,22,200,206,90,160,131,22,112,164,180,199,131,224,144,85,192,161,216,184,63,56,254,214,117,184,140,49,191,142,188,158,27,181,158,94,135,227,105,161,94,21,65,23,49,99,19,60,203,26,28,136,80,162,225,58,18,236,7,109,124,110,133,93,194,196,29,98,18,128,214,250,184,247,88,124,100,136,251,45,226,197,175,141,153,125,22,47,177,71,208,122,43,96,147,72,128,43,212,34,143,92,143,107,77,101,115,238,255,141,225,251,204,65,176,136,179,199,2,251,91,217,35,99,198,60,33,23,106,124,239,223,161,215,160,157,8,159,205,51,162,128,190,117,216,158,253,93,145,134,88,45,184,142,169,59,34,55,95,150,66,197,82,221,9,29,214,49,3,54,98,63,30,202,112,149,86,30,119,221,29,243,186,19,249,25,37,97,6,110,221,31,123,222,63,220,67,120,97,19,60,94,133,107,163,15,139,21,225,179,30,35,146,118,133,60,106,85,174,232,169,199,236,32,127,82,123,230,53,38,239,241,32,80,200,5,177,41,187,94,119,122,44,78,138,160,93,241,176,241,120,95,20,246,16,83,208,149,212,169,216,124,89,65,131,204,160,55,240,89,126,159,227,29,252,83,5,136,1,221,252,15,127,211,142,140,246,37,212,237,34,9,215,121,233,66,67,10,175,211,89,105,188,246,105,231,67,221,84,203,195,33,58,235,166,11,142,42,69,216,199,134,234,53,176,143,171,158,83,246,136,207,174,231,213,51,14,249,92,117,61,174,141,243,87,109,128,235,113,143,17,188,142,10,58,10,196,117,1,92,72,22,42,171,129,187,208,48,7,232,106,99,8,58,48,97,95,77,28,191,174,19,96,18,56,199,80,123,36,211,66,115,41,149,148,34,0,246,65,143,219,59,232,231,227,70,4,30,179,205,214,240,5,132,228,49,193,251,136,146,242,154,150,103,189,150,55,249,165,150,63,227,189,231,110,242,186,152,21,136,33,197,67,124,170,126,139,201,46,205,157,133,126,10,160,9,169,78,60,53,42,203,188,7,89,59,155,66,199,238,240,217,185,129,190,167,223,79,84,238,205,131,250,18,38,231,248,155,73,102,23,103,220,104,51,96,19,151,82,205,24,107,87,240,12,175,5,235,60,111,181,59,9,60,123,22,11,157,184,99,163,169,249,221,251,148,4,212,81,65,179,146,231,203,54,124,40,2,224,149,245,94,3,146,216,89,196,75,250,180,164,188,233,249,60,63,99,59,246,237,185,199,113,142,189,204,231,149,6,118,255,161,55,218,85,174,148,196,123,41,129,117,216,115,11,67,161,98,42,77,201,60,119,91,91,39,193,81,150,182,251,167,200,187,111,5,59,253,43,58,239,27,244,246,190,36,155,227,119,95,149,207,5,73,10,190,7,241,36,44,35,17,148,120,207,145,82,171,66,125,159,199,164,67,239,173,98,243,125,230,215,6,9,216,53,62,134,128,47,69,220,174,61,142,71,103,30,196,126,128,111,56,244,105,233,44,36,200,188,60,115,183,215,37,217,246,230,117,196,166,136,32,17,53,193,227,28,142,28,250,113,122,29,96,17,178,151,235,208,38,173,140,122,25,174,35,199,126,196,79,208,47,126,187,19,163,61,118,2,119,95,183,172,143,141,218,235,38,236,165,120,211,147,208,112,216,35,96,34,176,48,88,122,78,49,30,195,90,227,53,33,180,7,85,61,207,224,251,138,46,36,174,79,250,236,73,128,117,110,21,3,235,154,194,126,109,89,136,61,183,7,124,182,134,135,10,230,243,253,41,147,221,43,61,11,102,188,54,147,98,206,164,165,132,90,188,101,123,39,152,202,159,160,225,152,162,61,164,186,120,230,94,91,152,112,1,223,243,207,194,206,160,225,219,111,164,186,163,95,91,209,45,12,180,104,143,147,127,242,176,236,236,97,193,151,32,11,248,193,184,247,76,135,123,85,117,202,115,10,239,117,221,30,185,5,143,102,246,61,207,248,220,122,52,123,179,142,218,174,199,78,96,157,151,230,120,247,54,42,191,4,158,43,10,6,238,171,114,247,12,205,240,143,234,160,154,146,103,247,213,57,143,86,16,0,133,4,222,176,112,30,51,10,141,9,179,21,120,107,94,0,167,98,80,186,231,233,184,133,54,139,239,188,222,141,161,195,114,2,70,169,240,235,99,69,172,126,195,73,182,20,125,108,248,188,68,254,2,239,125,254,134,251,152,196,172,215,37,103,61,233,57,229,197,235,161,109,175,139,131,80,169,158,103,144,71,97,83,45,237,208,115,102,91,10,107,239,57,69,140,119,26,249,224,116,106,41,127,159,21,99,13,210,32,49,144,211,4,59,16,6,9,94,4,120,43,136,11,117,151,2,155,6,26,228,174,97,237,85,13,82,255,90,131,252,5,206,83,244,200,132,201,32,102,229,36,231,133,124,43,218,75,206,171,84,243,36,44,241,17,231,129,43,148,188,224,138,122,146,43,244,207,184,226,77,3,223,194,121,223,87,59,25,130,243,40,227,196,239,241,14,186,73,206,35,59,175,6,156,151,26,145,85,69,152,13,57,175,1,151,33,78,175,113,222,241,215,156,215,65,135,233,87,120,226,30,215,188,31,212,101,199,189,102,237,115,21,239,62,2,184,18,11,58,5,15,128,7,178,207,178,157,65,88,213,156,181,245,29,18,171,185,168,95,129,131,140,18,133,38,241,4,112,213,101,107,145,31,108,163,219,0,155,69,195,250,21,43,21,223,213,120,62,33,96,87,108,248,22,207,48,240,61,255,30,61,54,121,31,32,16,47,219,18,94,77,32,94,144,131,90,183,134,251,220,151,161,247,21,109,134,119,159,231,225,94,244,120,128,239,75,180,128,15,206,146,115,140,211,54,17,188,1,214,213,192,189,47,164,44,226,116,165,19,227,182,37,222,221,179,206,118,73,48,47,159,218,222,155,22,165,189,195,26,154,13,214,26,17,233,77,209,194,122,131,183,98,71,18,251,102,84,231,241,244,181,4,111,253,131,153,230,91,132,220,54,95,46,184,162,188,228,138,227,153,43,242,159,113,69,125,51,54,81,123,90,70,54,19,134,185,103,25,178,41,108,42,129,67,140,225,45,67,252,165,198,173,54,133,171,35,24,215,52,14,247,67,108,74,101,120,120,71,78,31,63,40,167,205,223,241,125,15,8,246,71,47,140,9,30,107,50,167,173,152,39,97,158,23,238,164,224,53,43,22,118,224,203,26,185,64,241,40,167,161,115,10,219,93,234,88,126,161,99,227,247,232,216,27,244,159,132,254,219,122,14,133,254,99,210,0,119,39,245,223,75,196,92,182,131,246,142,164,226,9,193,63,106,117,228,149,169,159,229,72,255,29,129,225,249,201,231,185,222,215,201,178,123,171,61,168,87,221,191,83,248,25,232,48,232,113,14,223,99,242,168,221,215,194,28,215,92,223,171,88,55,62,214,196,109,185,176,250,66,238,197,251,115,159,71,219,194,6,98,50,23,224,133,72,237,149,182,236,73,180,25,47,69,7,111,85,75,173,236,124,152,11,16,158,141,169,174,229,194,155,110,218,95,201,5,232,38,246,163,14,220,215,120,50,124,31,155,71,130,197,151,245,88,133,60,61,202,85,184,40,192,141,243,10,254,151,4,79,149,204,202,226,16,172,121,181,94,189,249,248,164,48,47,160,177,180,212,246,37,38,122,89,201,86,24,105,143,41,3,165,104,230,107,55,95,89,169,235,135,185,59,38,200,167,101,2,79,244,107,189,97,62,82,111,96,75,129,217,148,49,232,141,26,207,55,153,211,165,57,70,204,94,230,180,162,99,108,40,31,230,244,92,134,244,142,90,65,240,113,181,130,146,71,133,205,34,191,142,104,95,251,103,154,242,216,11,41,64,22,194,70,192,166,13,3,129,50,65,224,132,121,84,64,135,143,106,5,96,28,118,89,43,96,83,181,2,252,221,79,106,5,121,95,43,72,124,255,3,236,17,11,247,166,129,187,148,155,19,188,111,207,91,240,86,139,42,1,175,67,92,175,183,248,62,207,61,190,206,144,40,199,204,119,155,233,160,253,115,13,94,106,193,87,34,228,36,213,75,108,90,188,72,7,34,242,222,212,64,243,246,53,248,0,132,126,124,252,102,105,69,45,82,141,194,207,245,216,208,27,73,59,227,234,135,222,176,175,83,122,163,168,84,189,74,172,138,139,214,166,100,76,101,218,99,12,13,178,130,70,31,245,38,168,237,46,177,169,187,21,155,110,242,166,6,222,148,33,247,189,199,102,198,186,148,202,41,111,154,110,152,157,49,34,94,151,97,32,75,0,172,241,50,209,205,146,138,13,189,169,77,225,177,235,171,122,195,244,122,131,174,233,141,27,176,41,1,54,41,252,134,60,99,19,165,197,247,73,108,74,169,109,138,75,108,130,247,8,27,173,243,33,54,153,111,100,7,94,72,95,96,83,244,30,47,116,131,135,72,30,233,144,198,38,213,17,176,182,116,245,82,252,54,229,33,214,121,225,123,148,109,10,158,224,137,81,235,199,82,52,70,169,78,179,145,135,56,66,111,204,223,129,77,215,244,198,205,216,196,148,175,55,9,124,118,95,207,193,101,147,216,84,146,200,11,115,129,77,77,18,54,121,162,38,176,41,135,167,251,237,83,177,169,218,182,90,40,27,68,177,49,120,166,151,212,124,153,194,38,129,117,212,3,108,226,181,84,42,65,46,12,177,105,142,253,136,223,81,199,140,63,174,142,249,250,119,124,223,67,169,92,239,233,34,71,241,88,255,189,42,227,224,45,68,205,11,64,39,184,182,128,240,54,198,101,149,112,171,177,167,211,135,88,85,151,158,110,160,255,162,51,198,250,181,173,129,109,170,0,246,152,62,174,168,235,227,133,12,37,38,196,251,22,226,9,122,146,37,226,8,220,61,200,40,236,240,213,171,103,223,63,242,57,147,231,250,79,90,170,134,150,58,2,160,52,180,148,143,93,165,101,91,111,17,187,241,179,175,223,235,215,77,36,92,38,232,36,132,208,127,238,205,254,83,253,119,234,123,159,43,229,190,122,238,150,241,1,57,253,223,253,179,196,148,95,250,178,113,190,169,57,244,75,116,217,55,192,131,217,89,68,147,249,150,151,207,123,95,87,105,86,133,59,188,105,219,63,122,104,73,216,247,208,4,98,188,208,7,232,109,96,9,184,226,220,219,193,251,99,125,47,38,45,225,223,128,39,123,209,191,83,124,31,227,175,219,188,107,204,89,239,46,10,82,65,141,120,137,19,177,192,143,220,249,216,88,145,115,59,109,213,166,225,205,194,143,17,108,200,246,181,47,227,52,116,177,75,11,23,72,221,178,74,171,253,82,59,189,41,93,22,43,113,196,235,242,49,185,46,176,71,97,34,178,186,68,234,191,39,223,138,253,135,229,219,10,90,0,249,230,251,246,172,76,212,108,94,201,169,124,163,53,244,61,226,212,194,31,26,173,193,71,154,204,60,49,89,44,243,97,190,173,16,102,65,242,142,124,227,31,218,55,8,231,200,183,151,71,214,166,25,169,25,159,238,27,188,84,136,221,65,13,5,75,22,172,26,247,13,92,93,170,247,244,13,248,135,246,13,164,239,29,99,175,89,112,15,124,158,238,27,84,164,158,101,123,89,67,209,98,181,77,76,61,238,27,240,3,191,94,67,57,215,130,228,225,67,251,6,207,216,243,24,127,231,243,75,179,239,147,125,131,185,113,245,230,178,111,192,177,79,243,70,30,134,190,81,69,208,12,239,240,141,217,7,249,198,250,11,60,251,35,244,10,244,198,124,91,210,29,77,215,80,88,197,212,203,101,13,37,76,203,40,12,146,177,111,188,131,88,88,191,163,111,112,252,184,190,65,108,124,125,151,65,111,62,75,125,156,23,244,58,89,111,55,173,209,68,23,245,246,148,9,182,49,142,79,212,219,95,228,213,122,187,237,235,237,249,181,122,251,141,245,93,96,83,190,137,84,16,151,238,101,43,203,201,250,110,89,16,23,131,250,174,144,198,50,10,70,92,33,160,49,213,231,114,69,122,40,8,216,36,160,137,221,203,206,0,39,39,185,130,68,41,85,16,153,118,93,25,119,15,125,48,223,137,54,136,165,233,150,67,174,40,212,172,97,226,243,53,38,252,47,98,252,148,179,188,78,12,165,83,26,51,43,44,176,137,46,122,204,149,0,94,129,115,134,26,147,27,114,233,231,114,133,175,205,169,7,0,243,35,133,34,99,202,77,115,69,168,170,210,240,75,174,48,139,135,36,76,243,49,87,40,112,235,85,255,251,86,155,171,175,112,5,223,225,221,71,136,155,77,143,7,216,75,189,63,20,126,78,231,236,163,124,110,5,53,114,235,137,212,61,144,64,65,164,5,190,198,184,163,112,189,220,228,39,36,255,33,171,213,15,173,183,46,53,29,18,166,120,83,134,115,158,208,61,12,155,0,54,189,96,109,212,244,179,66,98,93,0,39,191,130,47,27,77,71,96,108,254,14,255,123,13,99,111,238,205,194,55,102,75,224,70,138,156,96,63,241,191,208,127,78,92,246,102,15,146,97,157,58,31,245,102,231,165,226,171,119,248,223,248,227,252,47,51,30,155,42,183,106,72,112,112,237,164,255,69,12,45,170,65,109,46,209,46,93,178,113,109,206,36,46,16,239,232,105,170,143,237,105,54,192,38,142,207,114,152,132,32,158,236,105,66,111,192,7,96,13,39,229,103,143,36,104,166,176,247,198,136,124,212,211,244,189,192,232,106,47,16,58,214,215,74,245,207,122,129,238,214,94,96,114,238,5,154,10,184,145,150,142,87,98,178,23,184,66,46,28,197,165,143,175,101,34,94,222,230,124,47,184,66,130,43,222,227,43,232,99,185,194,207,191,24,236,71,176,51,42,219,77,114,133,193,187,119,161,98,34,139,253,60,181,49,77,150,136,32,42,66,199,199,92,97,193,21,245,167,206,85,137,223,56,222,75,6,172,233,231,145,96,79,94,167,107,165,174,142,203,97,173,20,26,61,81,119,163,122,4,158,89,92,175,149,210,175,253,209,237,122,92,248,185,42,226,247,42,154,238,105,22,198,234,103,232,216,203,26,163,96,143,82,173,166,244,120,92,92,157,227,121,235,105,242,15,235,105,2,167,236,185,55,203,106,193,194,108,170,167,9,232,195,63,183,89,147,144,242,115,240,66,219,5,222,223,73,155,182,30,246,52,35,96,201,179,248,253,98,142,39,190,156,227,89,156,103,242,187,107,115,60,183,234,113,254,168,9,122,60,212,208,227,135,233,158,166,104,151,190,174,114,209,199,81,41,52,48,197,35,61,110,3,232,241,79,158,227,137,77,233,245,120,69,118,35,130,35,116,246,126,74,143,23,113,152,107,66,78,244,243,232,224,148,196,28,99,35,132,137,236,104,142,167,0,87,208,59,184,162,250,80,174,48,233,138,28,48,149,20,73,104,188,105,174,160,136,196,252,146,43,90,31,87,68,163,249,151,54,255,198,212,233,29,253,168,244,195,250,81,74,6,240,181,167,138,57,224,70,238,188,159,158,236,71,41,245,34,25,93,246,163,124,147,211,0,195,6,253,40,14,174,208,87,185,226,60,199,29,95,227,138,27,251,56,92,217,23,132,213,98,153,64,199,234,201,62,142,120,130,23,226,151,181,82,246,40,188,38,100,195,218,141,138,12,5,243,75,61,94,79,233,113,246,51,61,222,207,51,220,222,143,154,3,215,146,216,164,121,162,44,77,215,160,174,172,99,212,143,82,222,87,124,242,236,234,43,124,5,239,103,87,89,187,246,61,255,105,95,209,102,240,116,226,178,231,31,214,75,136,13,54,238,249,103,117,137,188,248,60,95,241,21,136,166,181,108,157,175,165,237,24,52,210,164,175,16,216,35,181,126,74,76,131,159,156,9,114,138,8,102,213,216,122,228,43,204,254,110,35,175,206,124,190,113,197,254,10,87,220,94,243,0,221,219,90,28,142,216,128,112,18,99,141,130,142,189,196,216,136,181,25,232,123,52,99,88,82,174,185,254,242,233,179,146,176,118,192,38,11,158,209,240,53,182,189,113,29,110,84,187,1,191,69,70,126,238,28,79,28,246,115,60,4,160,245,117,214,73,140,149,225,169,28,96,108,12,158,41,99,151,14,49,150,24,15,43,63,248,246,201,190,2,216,148,43,224,70,84,58,189,153,232,15,238,138,144,146,68,177,2,210,152,145,114,177,118,89,35,77,83,74,243,50,215,163,26,212,139,240,51,24,3,174,136,47,215,177,58,175,195,99,152,120,45,4,79,147,30,59,177,31,63,244,179,22,245,179,84,148,202,48,16,70,44,150,164,142,164,173,6,102,128,183,204,177,124,211,87,177,48,127,104,91,136,50,200,14,120,87,63,175,215,246,51,234,44,14,238,53,65,139,120,141,180,84,95,215,254,92,91,149,171,111,203,206,159,129,89,196,30,55,170,239,109,172,247,128,24,209,237,252,223,85,234,53,18,34,188,243,248,236,243,92,133,127,156,117,251,247,121,58,127,158,196,137,178,176,199,57,19,54,142,44,244,25,52,29,252,86,154,32,158,240,124,241,50,52,43,18,221,162,248,221,215,12,225,133,10,245,183,213,82,151,151,252,65,99,173,103,53,143,220,241,162,246,234,253,55,19,129,24,106,61,240,106,51,152,117,158,158,217,185,22,247,183,205,236,248,186,64,30,169,128,131,247,55,36,148,152,158,217,217,107,29,238,75,228,47,36,192,106,85,134,25,244,193,29,100,65,243,60,158,217,73,77,226,236,123,180,222,213,218,235,109,90,239,190,101,173,175,11,16,62,171,41,49,243,116,122,214,249,48,55,230,114,214,217,247,38,76,107,212,72,235,137,246,27,72,240,90,127,159,253,251,188,238,180,214,123,59,195,118,235,58,246,208,172,126,46,114,78,18,222,96,122,29,126,94,126,184,142,89,28,183,90,142,215,145,195,67,132,239,208,172,63,93,199,237,51,84,223,3,240,172,247,226,89,212,207,69,182,139,201,153,237,194,118,102,48,179,157,148,238,14,186,105,164,89,5,5,225,16,135,166,234,27,87,53,235,95,170,133,135,126,63,248,206,88,254,60,89,223,16,181,72,232,112,81,11,151,102,158,192,99,39,163,190,41,158,57,126,79,223,244,167,231,173,254,82,223,20,218,251,192,161,189,139,68,221,201,105,237,77,77,2,105,116,217,55,213,85,73,60,26,107,86,124,21,29,197,167,159,183,242,125,83,58,60,82,216,102,140,142,19,115,10,190,111,186,218,21,195,243,86,109,182,149,109,62,174,133,27,236,199,123,206,41,253,116,246,252,230,126,163,92,168,57,180,34,73,101,143,208,143,233,146,201,201,126,163,208,66,13,206,41,125,85,90,173,118,192,216,97,191,113,71,109,157,166,254,12,165,83,218,180,250,13,239,215,187,164,143,141,197,249,236,38,205,253,92,61,73,13,143,139,184,135,54,75,72,124,125,246,124,89,122,44,190,85,123,171,26,184,177,122,64,126,236,152,88,111,38,181,183,186,47,188,182,248,115,77,159,65,51,84,180,170,70,218,155,124,111,226,234,188,109,121,174,233,211,213,154,254,77,245,166,42,64,190,89,175,45,120,177,175,101,220,30,38,103,232,35,95,166,84,151,51,244,192,3,62,49,67,47,76,126,183,125,199,12,253,213,153,182,219,103,232,15,143,70,101,58,105,131,109,169,220,244,220,176,105,55,204,29,6,253,95,177,97,118,60,67,207,92,208,104,187,120,71,189,233,229,67,235,77,189,135,32,91,75,13,61,59,237,33,74,127,231,197,224,188,85,202,236,156,83,56,242,66,75,236,7,127,71,255,247,106,111,226,198,254,239,28,249,230,123,44,208,222,117,149,220,120,190,71,143,106,250,47,18,241,240,185,231,123,66,142,156,182,143,76,164,126,112,51,189,241,124,207,232,76,171,244,103,90,237,123,102,83,174,213,5,110,158,183,221,202,112,134,253,205,56,233,251,37,115,167,201,217,20,172,232,105,120,190,167,82,124,89,180,124,88,11,127,198,51,39,151,24,75,151,24,171,122,140,221,93,197,216,219,177,169,73,194,89,164,88,45,168,165,233,243,61,237,190,28,98,83,100,185,212,237,8,155,184,246,247,211,252,118,173,22,206,126,81,11,87,116,51,198,202,192,215,144,125,77,63,2,198,206,97,134,110,92,199,232,158,29,104,138,33,198,30,167,48,54,250,25,198,246,58,241,246,249,231,196,107,76,33,160,125,16,231,20,79,245,127,51,238,123,214,131,254,47,100,219,33,209,163,179,185,47,222,207,62,191,131,43,174,246,127,111,63,99,114,232,103,133,100,203,183,165,125,97,183,157,183,154,141,252,42,209,93,163,157,121,7,87,4,31,205,21,254,140,241,38,225,71,89,170,201,222,68,169,205,129,13,185,194,88,131,175,152,13,185,162,98,157,30,156,205,93,220,212,155,232,245,238,205,190,219,159,149,113,41,60,59,124,119,38,203,233,179,50,140,148,25,248,110,81,48,203,158,105,60,143,254,12,223,253,30,206,251,168,153,39,63,143,206,240,174,54,248,187,184,116,217,58,153,156,71,95,81,217,6,116,201,121,97,89,24,59,31,207,60,121,206,187,58,43,244,198,121,246,3,57,143,30,10,135,191,11,155,140,44,103,211,231,223,178,77,17,14,56,15,251,33,173,26,205,63,227,249,225,195,218,119,112,158,250,200,121,204,58,49,200,79,202,120,140,223,100,190,70,54,213,255,117,199,205,240,140,9,188,103,157,132,106,196,121,254,30,135,162,186,118,54,247,29,103,90,111,158,21,242,125,83,104,16,143,1,109,106,166,103,133,102,115,163,210,203,154,190,2,237,194,107,76,251,138,240,29,243,152,215,124,197,173,24,27,0,15,50,224,115,230,207,180,198,211,253,223,230,153,185,118,112,142,111,143,199,181,124,140,177,4,140,189,170,199,227,95,247,127,255,202,140,141,133,175,88,145,12,121,50,221,55,157,205,161,5,7,51,54,36,145,229,102,52,99,227,207,202,12,251,166,147,103,101,174,247,77,111,63,43,99,158,161,199,231,208,227,207,73,60,137,77,73,233,220,240,172,76,46,219,32,29,207,238,131,4,195,180,248,244,25,27,235,107,80,141,199,141,29,222,243,122,122,198,102,158,148,170,189,156,177,161,188,72,136,207,71,53,40,21,52,204,216,95,97,108,116,5,99,243,191,50,143,233,207,219,179,246,132,127,243,51,116,205,228,140,141,8,87,201,240,60,98,209,66,19,138,151,225,140,77,92,116,250,122,223,212,253,186,6,117,219,172,56,65,7,171,4,127,71,253,29,51,227,89,241,18,24,184,4,183,47,147,208,37,165,63,191,210,218,24,121,190,212,225,122,33,249,168,118,179,133,174,231,3,95,177,188,196,216,151,127,99,172,8,95,161,151,249,99,175,79,131,67,246,67,63,51,155,227,55,131,121,69,217,82,154,20,57,104,231,166,245,103,116,78,134,108,175,159,125,172,197,136,247,127,107,169,132,99,193,64,79,104,41,69,200,173,202,123,13,125,140,10,247,250,79,31,47,74,164,171,184,3,44,50,63,136,227,239,135,163,254,30,47,245,183,5,252,220,43,201,67,223,179,185,188,71,238,112,169,225,6,53,70,98,110,177,40,141,230,120,47,136,207,58,1,30,148,204,213,181,84,141,41,71,53,198,140,33,223,134,253,125,126,89,43,229,255,190,167,114,120,127,24,255,227,222,75,34,104,93,217,166,69,41,142,137,110,23,120,209,51,14,205,154,21,97,239,243,60,38,170,60,252,195,187,20,123,172,250,240,230,193,128,169,253,253,72,160,5,136,182,59,143,107,188,109,19,197,235,7,113,232,154,170,191,47,109,95,247,119,243,69,251,60,10,193,131,7,190,239,239,199,124,111,239,201,105,196,233,42,198,166,107,104,60,206,108,91,234,112,241,40,195,21,43,220,203,116,239,73,211,255,54,185,253,117,239,169,93,73,178,129,100,148,109,74,145,87,133,189,19,144,93,62,46,199,189,39,199,193,151,131,57,163,252,166,57,163,183,187,229,110,157,151,10,124,207,6,158,100,181,133,1,149,147,124,217,30,192,241,47,131,117,104,14,140,160,209,58,20,204,131,98,159,235,73,74,104,116,224,27,124,83,35,245,145,151,116,63,229,73,84,220,238,115,230,190,106,77,235,44,129,63,40,93,136,120,76,55,218,140,230,165,114,120,146,72,191,167,23,248,211,94,254,95,238,5,82,229,230,13,137,185,152,62,35,187,47,152,104,42,38,28,36,36,237,10,81,39,200,173,136,181,117,60,62,35,11,14,114,238,250,57,140,15,159,17,62,247,208,188,126,129,14,163,164,229,108,82,191,152,14,239,213,12,122,104,71,193,92,198,198,61,180,53,116,216,39,223,123,244,189,191,135,32,239,103,68,246,110,251,147,123,8,242,4,156,74,131,30,90,225,240,64,227,30,26,39,14,175,251,229,29,51,9,252,195,102,18,228,35,29,253,153,61,239,117,253,93,187,235,233,123,143,106,216,220,227,224,92,204,156,39,226,164,160,145,134,58,44,254,229,25,202,243,252,90,244,65,243,107,111,61,52,155,158,231,215,14,178,170,38,123,104,59,169,134,103,15,245,10,68,151,20,227,30,26,141,231,215,254,211,61,180,183,243,36,192,91,242,103,15,237,65,76,247,208,128,205,224,163,203,59,11,95,193,151,36,71,94,183,157,67,79,190,199,235,126,112,125,183,245,247,159,246,179,206,75,230,38,189,46,52,203,203,38,17,131,179,135,234,101,37,5,141,238,111,130,215,21,133,252,212,94,160,215,147,59,33,86,254,12,57,151,254,238,222,233,94,96,90,41,120,251,203,179,135,12,62,96,37,71,189,192,122,137,184,154,95,173,83,159,123,129,155,159,213,169,123,44,254,107,103,40,1,3,71,233,215,17,125,153,90,7,180,104,155,13,207,80,166,208,99,243,241,221,59,124,13,93,44,222,209,211,252,233,58,254,90,79,147,123,207,142,207,222,237,72,176,124,178,246,96,194,2,112,112,121,78,201,241,136,132,90,143,206,41,217,151,72,134,221,39,158,5,253,81,123,168,207,245,93,119,252,201,89,80,205,180,13,6,189,192,54,215,237,108,124,135,16,189,96,243,174,214,119,63,184,246,224,185,59,247,243,22,240,161,71,248,44,78,147,220,221,206,82,0,214,229,157,133,98,111,24,32,99,92,123,240,218,150,125,250,157,133,113,120,42,34,11,31,195,252,157,133,102,250,94,48,186,55,76,92,222,89,40,253,57,87,179,30,113,55,211,225,146,222,193,221,20,124,228,60,161,175,239,154,252,92,67,57,110,166,185,123,197,74,225,6,220,29,234,210,78,221,55,50,3,119,155,205,39,206,158,131,187,107,6,140,245,119,47,150,137,10,164,158,188,167,131,239,164,165,1,119,191,62,72,196,92,57,186,55,128,126,205,221,238,215,247,116,220,56,55,178,17,66,203,31,181,135,233,185,145,254,126,179,205,248,126,51,181,76,70,231,212,241,159,150,199,159,62,55,66,254,78,14,122,0,136,238,152,89,76,207,108,211,235,18,254,104,80,223,117,41,115,199,122,84,223,197,51,203,176,249,204,179,160,102,237,14,9,252,209,22,220,45,141,61,198,211,189,192,180,50,200,163,203,187,144,22,160,143,23,223,187,27,244,2,3,111,218,154,207,239,105,250,117,240,141,175,105,193,107,113,250,109,114,29,134,145,139,6,119,58,197,218,184,116,220,211,12,98,112,247,242,29,61,205,159,174,227,47,245,52,213,203,163,182,254,140,177,191,255,224,101,186,126,224,177,222,14,207,91,33,143,45,159,152,193,117,141,81,226,83,207,91,197,191,155,130,16,163,254,78,79,225,239,27,254,201,89,128,159,159,183,26,221,127,224,203,176,201,245,250,193,241,215,247,255,221,56,243,25,183,61,231,69,240,171,43,217,78,115,30,18,50,25,158,83,146,238,32,99,59,186,167,87,196,65,88,69,87,57,175,254,245,12,253,173,247,6,184,140,200,175,163,171,19,163,204,116,157,186,37,9,174,184,168,83,151,70,39,202,140,234,212,188,236,52,143,127,127,199,89,208,107,51,159,55,250,163,196,251,35,127,166,213,247,2,237,116,47,176,191,111,110,120,22,212,206,215,194,141,252,209,198,223,233,84,86,159,122,22,148,25,95,79,52,51,94,2,215,105,250,126,91,22,217,23,57,60,11,106,250,243,86,243,209,108,158,246,61,205,223,127,125,167,251,245,179,160,55,97,236,6,24,27,157,49,86,167,198,58,25,79,98,44,242,21,56,52,192,216,36,178,119,220,236,71,115,35,2,62,239,250,61,189,230,215,24,123,219,157,158,98,137,223,152,227,239,26,248,156,180,168,166,106,130,120,199,109,59,184,55,224,164,129,53,203,104,63,170,9,154,196,185,228,115,231,20,108,4,160,124,211,177,200,183,73,29,187,46,18,96,235,101,47,112,197,138,246,133,177,81,13,106,70,191,212,177,255,145,94,160,191,167,151,173,8,30,181,82,199,233,187,89,212,186,144,224,186,139,94,160,169,253,255,43,101,116,55,139,159,71,167,246,234,125,195,255,137,187,73,61,198,114,58,255,255,63,100,165,252,253,127,251,19,83,255,245,95,255,31,214,105,175,229,144,109,0,0]}]'

length = len(response)+1
buffer = lok._malloc(length)
lok.stringToUTF8Array(response, lok.HEAPU8, buffer, length)
lok.dynCall_vii(17691, 3, buffer)
lok._free(buffer)

lok.START_DEBUG = True
lok.dynCall_vi(17961, 0)

with open('after.bin', 'wb') as ifile:
    ifile.write(bytes(lok.HEAP8))
print('done')

# session = lok.session
# headers= {
#     'content-type' : 'application/x-www-form-urlencoded',
#     'user-agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36',
#     'x-access-token':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NjdhYjVlNTNiYTdjNzYyZDEyYTk4YWEiLCJraW5nZG9tSWQiOiI2NjdhYjVmOGYyNjk3Y2E4ODkyYTY3ODEiLCJ3b3JsZElkIjoyNiwidmVyc2lvbiI6MTc3NSwiYXV0aFR5cGUiOiJlbWFpbCIsInBsYXRmb3JtIjoid2ViIiwidGltZSI6MTcyOTkxOTY0NDE3MCwiY2xpZW50WG9yIjoiMCIsImlwIjoiMTc1LjE0My4yMzUuMjQwIiwiaWF0IjoxNzI5OTE5NjQ0LCJleHAiOjE3MzA1MjQ0NDQsImlzcyI6Im5vZGdhbWVzLmNvbSIsInN1YiI6InVzZXJJbmZvIn0.4MbDpQHDGXC3wss328ZOcTHbwUHXOogESvGlQ7rgo20'
# }
# data = {'json': 'VRg='}
# r = session.post("https://api-lok-live.leagueofkingdoms.com/api/kingdom/task/all", headers=headers, data=data)
# lok.rpcs[387] = r
# response = r.result().content
# byteArray = np.frombuffer(response, dtype=np.uint8)
# buffer = lok._malloc(len(byteArray))
# lok.HEAPU8[buffer: buffer+len(byteArray)] = byteArray
# lok.dynCall_viiiii(1894, 387, 200, buffer, len(byteArray), 0)
# with open('after.bin', 'wb') as ifile:
#     ifile.write(bytes(lok.HEAP8))
# print('done')

# a = LokService()
# a.login()
# token = a.accessToken

# logging.info("Started")
# lok.START_DEBUG = True
# URL = f"wss://socf-lok-live.leagueofkingdoms.com/socket.io/?EIO=4&transport=websocket&token={token}"
# lok._WS_Create(URL, '', 17058,17691,14198,17692,14199)
# print('\ndebug started')


time.sleep(300)